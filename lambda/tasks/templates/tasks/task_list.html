{% extends 'base/base_list.html' %}

{% block title %}
  <title>Tasks | Lambda</title>
{% endblock title %}

{% block nav %}
  {% include "tasks/task_nav.html" %}
{% endblock nav %}

{% block tableHeaders %}
  <th class="sortHeader" data-sorted="true" data-table-id="sortTable1" data-col="0" data-type="number"
    scope="col">
    #
  </th>
  <th class="sortHeader" data-sorted="false" data-table-id="sortTable1" data-col="1" data-type="text" scope="col">
    Title
  </th>
  <th class="sortHeader" data-sorted="false" data-table-id="sortTable1" data-col="2" data-type="text" scope="col">
    Project
  </th>
  <th class="sortHeader" data-sorted="false" data-table-id="sortTable1" data-col="3" data-type="number"
    scope="col">
    Priority
  </th>
  <th class="sortHeader" data-sorted="false" data-table-id="sortTable1" data-col="4" data-type="number"
    scope="col">
    Due in
  </th>
  <th class="d-none" data-sorted="false" data-table-id="sortTable1" data-col="5" data-type="text"
    scope="col">
    Status
  </th>
{% endblock tableHeaders %}

{% block tableBody %}
  <!-- We add a rotation of 0 to table rows so that the strechted links apply to the appropriate area. -->
  {% for task in object_list %}
    <tr class="{% if task.completed %}table-success{% endif %}" style="transform: rotate(0);">
      <th scope="row">
        <a href="{% url 'task-detail' task.id %}" class="stretched-link"></a>
        {{ task.id }}
      </th>
      <td>{{ task.title }}</td>
      <td>{{ task.project }}</td>

      {% if task.priority_level <= 3 %}
        <td class="text-success" data-sort-value="{{ task.priority_level }}">
          {{ task.get_priority_level_display }}
        </td>
      {% elif task.priority_level <= 6 %}
        <td class="text-warning" data-sort-value="{{ task.priority_level }}">
          {{ task.get_priority_level_display }}
        </td>
      {% elif task.priority_level <= 9 %}
        <td class="text-danger" data-sort-value="{{ task.priority_level }}">
          {{ task.get_priority_level_display }}
        </td>
      {% else %}
        <td data-sort-value="{{ task.priority_level }}">
          {{ task.get_priority_level_display }}
        </td>
      {% endif %}

      {% if task.days_till_due > 7 %}
        <td class="text-success" data-sort-value="{{ task.days_till_due }}">
          {{ task.days_till_due }}&nbsp;days
        </td>
      {% elif task.days_till_due > 0 and task.days_till_due <= 7 %}
        <td class="text-warning" data-sort-value="{{ task.days_till_due }}">
          {{ task.days_till_due }}&nbsp;days
        </td>
      {% else %}
        <td class="text-danger" data-sort-value="{{ task.days_till_due }}">
          {{ task.days_till_due }}&nbsp;days
        </td>
      {% endif %}
      <td class="d-none">
        {% if task.completed %}
          Completed
        {% else %}
          In Progress
        {% endif %}
      </td>
    </tr>
  {% endfor %}
{% endblock tableBody %}
