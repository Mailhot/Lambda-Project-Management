{# To be included in project detail view with a context of task_list containing tasks relevant to that project #}

<div class="mb-3">
  <button class="btn btn-outline-primary" type="button" data-toggle="collapse" data-target="#collapseTable1" aria-expanded="false" aria-controls="collapseTable1">View Tasks</button>
</div>

<div class="collapse" id="collapseTable1">
  <table id="sortTable1" class="table table-hover">
    <thead>
      <tr>
        <th class="sortHeader" data-sorted="true" data-table-id="sortTable1" data-col="0" data-type="number"
          scope="col">
          #
        </th>
        <th class="sortHeader" data-sorted="false" data-table-id="sortTable1" data-col="1" data-type="text" scope="col">
          Title
        </th>
        <th class="sortHeader" data-sorted="false" data-table-id="sortTable1" data-col="2" data-type="text" scope="col">
          Assigned to
        </th>
        <th class="sortHeader" data-sorted="false" data-table-id="sortTable1" data-col="3" data-type="number"
          scope="col">
          Priority
        </th>
        <th class="sortHeader" data-sorted="false" data-table-id="sortTable1" data-col="4" data-type="number" scope="col">
          Due in
        </th>
      </tr>
    </thead>
    <tbody>
      {% for task in task_list %}
        <tr onclick="window.document.location='{% url 'task-detail' task.id %}';"
          {% if task.completed %}class="table-success" {% endif %}>
          <th scope="row">{{ task.id }}</th>
          <td>{{ task.title }}</td>
          <td>{{ task.assigned_to_user }}</td>

          {% if task.priority_level <= 3 %}
            <td class="text-success" data-sort-value="{{ task.priority_level }}">
              {{ task.get_priority_level_display }}
            </td>
          {% elif task.priority_level <= 6 %}
            <td class="text-warning" data-sort-value="{{ task.priority_level }}">
              {{ task.get_priority_level_display }}
            </td>
          {% elif task.priority_level <= 9 %}
            <td class="text-danger" data-sort-value="{{ task.priority_level }}">
              {{ task.get_priority_level_display }}
            </td>
          {% else %}
            <td data-sort-value="{{ task.priority_level }}">
              {{ task.get_priority_level_display }}
            </td>
          {% endif %}

          {% if task.days_till_due > 7 %}
            <td class="text-success" data-sort-value="{{ task.days_till_due }}">
              {{ task.days_till_due }}&nbsp;days
            </td>
          {% elif task.days_till_due > 0 and task.days_till_due <= 7 %}
            <td class="text-warning" data-sort-value="{{ task.days_till_due }}">
              {{ task.days_till_due }}&nbsp;days
            </td>
          {% else %}
            <td class="text-danger" data-sort-value="{{ task.days_till_due }}">
              {{ task.days_till_due }}&nbsp;days
            </td>
          {% endif %}
        </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
